## üöæ Hist√≥rico de Erros e Solu√ß√µes - Conex√£o com MongoDB (Projeto HabitsApp) 20.04.25

Durante o desenvolvimento da API backend do projeto **HabitsApp**, encontramos uma s√©rie de erros relacionados √† conex√£o com o banco de dados **MongoDB Atlas**. Abaixo est√° um relato documentado de todos os erros enfrentados e como cada um foi solucionado. Isso serve tanto como aprendizado quanto como guia de refer√™ncia para futuros projetos.

---

### üìç Problema 1: `.env` n√£o estava sendo carregado corretamente

**Erro:**
```bash
The `uri` parameter to `openUri()` must be a string, got "undefined".
```

**Causa:**
- O arquivo `.env` existia, mas o conte√∫do **n√£o estava sendo lido** corretamente pelo `dotenv`.

**Solu√ß√£o:**
- Foi necess√°rio **deletar o `.env` antigo e criar um novo manualmente**, com a codifica√ß√£o correta e sem espa√ßos extras ou caracteres invis√≠veis.

---

### üìç Problema 2: `MODULE_NOT_FOUND` ao tentar carregar `.env`

**Erro:**
```bash
Error: Cannot find module '.env'
```

**Causa:**
- Tentativa de importar o `.env` com `require('.env')`, quando o correto seria apenas carregar o conte√∫do usando `dotenv`.

**Solu√ß√£o:**
- Corrigir o c√≥digo para:
  ```js
  require('dotenv').config();
  ```

---

### üìç Problema 3: Vari√°vel `MONGO_URI` ainda retornando `undefined`

**Debug:**
```js
console.log(process.env.MONGO_URI); // retornava undefined
```

**Causa:**
- `.env` n√£o estava sendo corretamente reconhecido, mesmo ap√≥s corre√ß√µes iniciais.

**Solu√ß√£o:**
- Verificar se o arquivo `.env` estava realmente salvo na **pasta correta** (`habits-backend`).
- Garantir que n√£o existia nenhuma extens√£o no nome do arquivo como `.env.txt`.

---

### üìç Problema 4: Erro de autentica√ß√£o no MongoDB

**Erro:**
```bash
MongoServerError: bad auth : authentication failed
```

**Causa:**
- O usu√°rio ou senha do MongoDB Atlas estavam incorretos.
- A URI estava com `<senha>` escrita literalmente ou com caracteres especiais mal formatados.

**Solu√ß√£o:**
- Atualizar a vari√°vel `MONGO_URI` no `.env` com a senha correta e sem caracteres especiais quebrando a string.
- Exemplo:
  ```env
  MONGO_URI=mongodb+srv://usuario:senha@host.mongodb.net/?retryWrites=true&w=majority&appName=MeuApp
  ```

---

### ‚úÖ Solu√ß√£o Final

Ap√≥s todos os ajustes, o log passou a exibir com sucesso:

```bash
Servidor rodando na porta 5000
Conectado ao MongoDB
```

---

### üß† Aprendizados

- Sempre verifique se o `.env` est√° **corretamente salvo e formatado**.
- Utilize `console.log` para depurar vari√°veis de ambiente.
- Senhas com caracteres especiais devem ser **URL encoded** ou evitadas para conex√µes simples.
- Nunca subestime um `.env` bugado ‚Äî √†s vezes o problema t√° no invis√≠vel!

---

### ü´† Dica extra

Adicione o `.env` ao `.gitignore` para evitar que ele v√° pro GitHub:

```bash
# .gitignore
.env
```

---



